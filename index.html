<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WillowSteeps</title>
    <link rel="stylesheet" href="styles.css">
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js";
        import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAMOc6n_-UxqouQ8YcPb21cZ7tA79ISRSM",
            authDomain: "willowsteeps-fcca5.firebaseapp.com",
            projectId: "willowsteeps-fcca5",
            storageBucket: "willowsteeps-fcca5.appspot.com",
            messagingSenderId: "814830989524",
            appId: "1:814830989524:web:5b55c19b4155e58564cb41",
            measurementId: "G-ZLP5BZGBLQ"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);

        document.addEventListener('DOMContentLoaded', () => {
            const reviewForm = document.getElementById('review-form');
            const reviewsList = document.getElementById('reviews-list');

            // Load reviews from Firestore
            const loadReviews = async () => {
                const querySnapshot = await getDocs(collection(db, "reviews"));
                reviewsList.innerHTML = '';
                querySnapshot.forEach((doc) => {
                    const review = doc.data();
                    const reviewElement = document.createElement('div');
                    reviewElement.className = 'review';
                    reviewElement.innerHTML = `
                        <h3>${review.name}</h3>
                        <p>Rating: ${review.rating}/10</p>
                        <p>${review.review}</p>
                    `;
                    reviewsList.appendChild(reviewElement);
                });
            };

            // Save review to Firestore
            const saveReview = async (review) => {
                try {
                    await addDoc(collection(db, "reviews"), review);
                    loadReviews();
                } catch (e) {
                    console.error("Error adding document: ", e);
                }
            };

            // Handle form submission
            reviewForm.addEventListener('submit', (event) => {
                event.preventDefault();
                const name = document.getElementById('tea-name').value;
                const rating = document.getElementById('tea-rating').value;
                const review = document.getElementById('tea-review').value;

                if (name && rating && review) {
                    const newReview = {
                        name,
                        rating: parseInt(rating),
                        review
                    };
                    saveReview(newReview);
                    reviewForm.reset();
                }
            });

            // Initial load
            loadReviews();
        });
    </script>
</head>
<body>
    <header>
        <div class="container">
            <h1>WillowSteeps</h1>
            <p>Discover and rate the finest teas with WillowSteeps</p>
        </div>
    </header>
    <main>
        <section class="intro">
            <div class="container">
                <h2>Welcome to WillowSteeps</h2>
                <p>We provide tea recommendations and rate teas out of 10. Join our community of tea enthusiasts!</p>
            </div>
        </section>
        <section class="reviews">
            <div class="container">
                <h2>Latest Tea Reviews</h2>
                <div id="reviews-list">
                    <!-- User reviews will be appended here -->
                </div>
                <div class="review-form">
                    <h3>Leave a Review</h3>
                    <form id="review-form">
                        <input type="text" id="tea-name" placeholder="Tea Name" required>
                        <input type="number" id="tea-rating" placeholder="Rating (out of 10)" min="1" max="10" required>
                        <textarea id="tea-review" placeholder="Write your review here..." required></textarea>
                        <button type="submit">Submit Review</button>
                    </form>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <div class="container">
            <p>&copy; 2024 WillowSteeps. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>
